services:

    SubscriptionBundle\Piwik\Service\CurrencyConverter:
        arguments: ['@SubscriptionBundle\Repository\ExchangeRateRepository']

    SubscriptionBundle\Piwik\EventPublisher:
        arguments:
            - '@SubscriptionBundle\Piwik\Profiler\TraceableSender'
            - '@SubscriptionBundle\Piwik\Formatter\LegacyPiwikFormatter'
            - '@logger'

    SubscriptionBundle\Piwik\Service\AdditionalDataProvider: ~

    SubscriptionBundle\Piwik\Service\AffiliateStringProvider:
        arguments: ['@SubscriptionBundle\Affiliate\Service\CampaignExtractor']

    SubscriptionBundle\Piwik\Service\OrderNameProvider:
        arguments: ['@SubscriptionBundle\Affiliate\Service\CampaignExtractor', '@SubscriptionBundle\Subscription\Subscribe\Common\ZeroCreditSubscriptionChecking']

    SubscriptionBundle\Piwik\Senders\RabbitMQ:
        arguments:
            - '_rabbitmq_host_placeholder_'
            - '_rabbitmq_port_placeholder_'
            - '_rabbitmq_user_placeholder_'
            - '_rabbitmq_password_placeholder_'
            - '_rabbitmq_vhost_placeholder_'
            - '_rabbitmq_exchange_name_placeholder_'
            - '_rabbitmq_queue_name_placeholder_'

    SubscriptionBundle\Piwik\Formatter\LegacyPiwikFormatter: ~

    SubscriptionBundle\Piwik\DataMapper\ConversionEventMapper:
        arguments:
            - '@SubscriptionBundle\Piwik\DataMapper\UserInformationMapper'
            - '@SubscriptionBundle\Piwik\Service\AdditionalDataProvider'
            - '@SubscriptionBundle\Piwik\Service\AffiliateStringProvider'
            - '@SubscriptionBundle\Piwik\DataMapper\OrderInformationMapper'

    SubscriptionBundle\Piwik\DataMapper\OrderInformationMapper:
        arguments:
            - '@SubscriptionBundle\Affiliate\Service\CampaignExtractor'
            - '@SubscriptionBundle\Piwik\Service\OrderNameProvider'
            - '@SubscriptionBundle\Piwik\Service\CurrencyConverter'

    SubscriptionBundle\Piwik\DataMapper\SubscribeClickEventMapper: ~

    SubscriptionBundle\Piwik\DataMapper\UnsubscribeClickEventMapper: ~

    SubscriptionBundle\Piwik\DataMapper\UserInformationMapper:
        arguments:
            - '@SubscriptionBundle\Piwik\Service\AffiliateStringProvider'
            - '@IdentificationBundle\User\Service\UserExtractor'
            - '@CountryCarrierDetectionBundle\Service\MaxMindIpInfo'
            - '@IdentificationBundle\Identification\Service\CarrierResolver'
            - '@IdentificationBundle\Identification\Service\DeviceDataProvider'

    SubscriptionBundle\Piwik\Profiler\TraceableSender:
        arguments:
            - '@SubscriptionBundle\Piwik\Senders\RabbitMQ'

    SubscriptionBundle\Piwik\Profiler\TraceableSenderCollector:
        arguments: ['@SubscriptionBundle\Piwik\Profiler\TraceableSender']
        tags:
            - { name: data_collector,  template: '@Subscription/profiler/piwik_events.html.twig', id: 'subscription.piwik_events_collector'  }