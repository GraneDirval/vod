services:
  SubscriptionBundle\CAPTool\Visit\VisitStorage:
    arguments: ['@subscription.captool.redis_client', '@SubscriptionBundle\CAPTool\Visit\ConstraintValidityChecker']

  SubscriptionBundle\CAPTool\Visit\ConstraintValidityChecker: ~

  SubscriptionBundle\CAPTool\Visit\VisitChecker:
    arguments: ['@SubscriptionBundle\CAPTool\Visit\VisitStorage', '@SubscriptionBundle\CAPTool\Visit\KeyGenerator']

  SubscriptionBundle\CAPTool\Visit\VisitTracker:
    arguments:
      - '@SubscriptionBundle\CAPTool\Visit\ConstraintValidityChecker'
      - '@SubscriptionBundle\CAPTool\Visit\VisitStorage'
      - '@SubscriptionBundle\CAPTool\Visit\KeyGenerator'
      - '@logger'

  SubscriptionBundle\CAPTool\Visit\VisitNotifier:
    arguments: ['@SubscriptionBundle\CAPTool\Visit\ConstraintValidityChecker', '@SubscriptionBundle\CAPTool\Subscription\Notificaton\CAPNotificationSender', '@SubscriptionBundle\Service\EntitySaveHelper']

  SubscriptionBundle\CAPTool\Visit\KeyGenerator: ~


  SubscriptionBundle\CAPTool\Visit\Command\ResetVisitConstraints:
    arguments:
      - '@SubscriptionBundle\CAPTool\Visit\VisitStorage'
    tags:
      - { name: console.command }