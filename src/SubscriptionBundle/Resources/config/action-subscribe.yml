services:
    SubscriptionBundle\Subscription\Subscribe\Subscriber:
        arguments:
            - '@logger'
            - '@SubscriptionBundle\Service\EntitySaveHelper'
            - '@session'
            - '@SubscriptionBundle\Subscription\Common\SubscriptionFactory'
            - '@SubscriptionBundle\Subscription\Common\PromotionalResponseChecker'
            - '@SubscriptionBundle\Subscription\Subscribe\OnSubscribeUpdater'
            - '@SubscriptionBundle\CAPTool\Subscription\SubscriptionLimitCompleter'
            - '@SubscriptionBundle\Subscription\Subscribe\Common\SubscribePerformer'
            - '@SubscriptionBundle\Subscription\Subscribe\Common\SubscribePromotionalPerformer'
            - '@cross_subscription.api_connector'
            - '@SubscriptionBundle\Subscription\Common\ProcessResultSuccessChecker'
            - '@SubscriptionBundle\Affiliate\Service\CampaignExtractor'


    SubscriptionBundle\Subscription\Subscribe\Handler\SubscriptionHandlerProvider:
        arguments: ['@SubscriptionBundle\Subscription\Subscribe\Handler\DefaultHandler']

    SubscriptionBundle\Subscription\Subscribe\Common\CommonFlowHandler:
        arguments:
            - '@SubscriptionBundle\Subscription\Common\SubscriptionExtractor'
            - '@SubscriptionBundle\SubscriptionPack\SubscriptionPackProvider'
            - '@SubscriptionBundle\Subscription\Subscribe\Subscriber'
            - '@SubscriptionBundle\Subscription\Subscribe\Common\SubscriptionEligibilityChecker'
            - '@logger'
            - '@SubscriptionBundle\Subscription\Subscribe\Handler\SubscriptionHandlerProvider'
            - '@SubscriptionBundle\Subscription\Subscribe\Common\CommonResponseCreator'
            - '@ExtrasBundle\Utils\UrlParamAppender'
            - '@SubscriptionBundle\Service\EntitySaveHelper'
            - '@SubscriptionBundle\Subscription\Subscribe\Common\SubscriptionEventTracker'
            - '@SubscriptionBundle\Subscription\Subscribe\Common\ZeroCreditSubscriptionChecking'
            - '@SubscriptionBundle\Subscription\Common\RouteProvider'
            - '@SubscriptionBundle\Subscription\Subscribe\Common\AffiliateNotifier'
            - '@SubscriptionBundle\Affiliate\Service\CampaignExtractor'
            - '@SubscriptionBundle\Subscription\Subscribe\Common\AfterSubscriptionProcessTracker'


    SubscriptionBundle\Subscription\Subscribe\Common\SubscriptionEligibilityChecker: ~

    SubscriptionBundle\Subscription\Unsubscribe\UnsubscriptionEligibilityChecker: ~

    SubscriptionBundle\Subscription\Common\RedirectUrlNullifier:
        arguments: ['@SubscriptionBundle\Service\EntitySaveHelper']

    SubscriptionBundle\Subscription\Subscribe\Service\BlacklistVoter:
        arguments:
            - '@router'
            - '@SubscriptionBundle\Blacklist\BlacklistChecker'
            - '@logger'

    SubscriptionBundle\Subscription\Subscribe\OnSubscribeUpdater:
        arguments:
            - '@SubscriptionBundle\Subscription\Common\SubscriptionExtractor'
            - '@SubscriptionBundle\Subscription\Subscribe\Service\CreditsCalculator'
            - '@SubscriptionBundle\Subscription\Renew\Service\RenewDateCalculator'
            - '@SubscriptionBundle\Subscription\Common\CommonSubscriptionUpdater'
            - '@SubscriptionBundle\Subscription\Common\ProcessResultSuccessChecker'
            - '@SubscriptionBundle\CAPTool\Subscription\SubscriptionLimiter'

    SubscriptionBundle\Subscription\Subscribe\Common\CommonResponseCreator:
        arguments:
            - '@SubscriptionBundle\Subscription\Common\SubscriptionExtractor'
            - '@SubscriptionBundle\Subscription\Common\RedirectUrlNullifier'

    SubscriptionBundle\Subscription\Subscribe\Common\SubscribePerformer:
        arguments:
            - '@SubscriptionBundle\BillingFramework\Process\SubscribeProcess'
            - '@SubscriptionBundle\Subscription\Subscribe\SubscribeParametersProvider'

    SubscriptionBundle\Subscription\Subscribe\Common\SubscribePromotionalPerformer:
        arguments:
            - '@logger'
            - '@SubscriptionBundle\Subscription\Notification\Notifier'
            - '@SubscriptionBundle\Subscription\Common\FakeResponseProvider'
            - '@SubscriptionBundle\Subscription\Common\SubscriptionSerializer'

    SubscriptionBundle\Subscription\Subscribe\Handler\DefaultHandler: ~

    SubscriptionBundle\Subscription\Subscribe\SubscribeParametersProvider:
        arguments:
            - '@SubscriptionBundle\Subscription\Common\RequestParametersProvider'
            - '@request_stack'
            - '@router'
            - '@SubscriptionBundle\Subscription\Subscribe\Common\ZeroCreditSubscriptionChecking'
            - '@SubscriptionBundle\Affiliate\Service\CampaignExtractor'

    SubscriptionBundle\Subscription\Subscribe\Common\SubscriptionEventTracker:
        arguments:
            - '@SubscriptionBundle\Subscription\Subscribe\Common\SubscriptionEventChecker'
            - '@SubscriptionBundle\Piwik\DataMapper\ConversionEventMapper'
            - '@SubscriptionBundle\Piwik\EventPublisher'
            - '@logger'

    SubscriptionBundle\Subscription\Subscribe\Consent\ConsentFlowHandler:
        arguments:
            - '@logger'
            - '@SubscriptionBundle\Subscription\Common\SubscriptionExtractor'
            - '@SubscriptionBundle\SubscriptionPack\SubscriptionPackProvider'
            - '@SubscriptionBundle\Subscription\Subscribe\Subscriber'
            - '@SubscriptionBundle\Service\EntitySaveHelper'
            - '@IdentificationBundle\Identification\Service\RouteProvider'
            - '@SubscriptionBundle\Subscription\Subscribe\Common\SubscriptionEligibilityChecker'
            - '@ExtrasBundle\Utils\UrlParamAppender'
            - '@router.default'
            - '@SubscriptionBundle\Subscription\Subscribe\Common\CommonResponseCreator'
            - '@SubscriptionBundle\Subscription\Subscribe\Common\AffiliateNotifier'
            - '@SubscriptionBundle\Affiliate\Service\CampaignExtractor'
            - '@SubscriptionBundle\Subscription\Subscribe\Common\AfterSubscriptionProcessTracker'

    SubscriptionBundle\Subscription\Subscribe\Controller\SubscribeAction:
        tags: ['controller.service_arguments']
        arguments:
            - '@IdentificationBundle\User\Service\UserExtractor'
            - '@SubscriptionBundle\Subscription\Subscribe\Common\CommonFlowHandler'
            - '@SubscriptionBundle\Subscription\Subscribe\Handler\SubscriptionHandlerProvider'
            - '@SubscriptionBundle\Subscription\Subscribe\Service\BlacklistVoter'
            - '@IdentificationBundle\Identification\Handler\IdentificationHandlerProvider'
            - '@IdentificationBundle\Repository\CarrierRepositoryInterface'
            - '@IdentificationBundle\Identification\Common\PostPaidHandler'
            - '@SubscriptionBundle\CampaignConfirmation\Handler\CampaignConfirmationHandlerProvider'
            - '@SubscriptionBundle\CAPTool\Subscription\SubscriptionLimiter'
            - '@SubscriptionBundle\Blacklist\BlacklistAttemptRegistrator'
            - '@SubscriptionBundle\Subscription\Subscribe\Voter\BatchSubscriptionVoter'
            - '@IdentificationBundle\Identification\Service\RouteProvider'
            - '@SubscriptionBundle\Subscription\Common\RouteProvider'


    SubscriptionBundle\Subscription\Subscribe\Controller\FakeSubscribeAction:
        tags: ['controller.service_arguments']
        arguments:
            - '@IdentificationBundle\User\Service\UserExtractor'
            - '@router.default'
            - '@logger'
            - '@SubscriptionBundle\Subscription\Common\SubscriptionExtractor'
            - '@SubscriptionBundle\SubscriptionPack\SubscriptionPackProvider'
            - '@SubscriptionBundle\Service\EntitySaveHelper'
            - '@IdentificationBundle\Identification\Service\RouteProvider'

    SubscriptionBundle\Subscription\Subscribe\Controller\ConsentPageSubscribeAction:
        tags: ['controller.service_arguments']
        arguments:
            - '@IdentificationBundle\Repository\CarrierRepositoryInterface'
            - '@IdentificationBundle\Identification\Handler\IdentificationHandlerProvider'
            - '@SubscriptionBundle\Subscription\Subscribe\Handler\SubscriptionHandlerProvider'
            - '@IdentificationBundle\User\Service\UserExtractor'
            - '@SubscriptionBundle\Subscription\Subscribe\Consent\ConsentFlowHandler'
            - '@SubscriptionBundle\Subscription\Subscribe\Service\BlacklistVoter'
            - '@SubscriptionBundle\Blacklist\BlacklistAttemptRegistrator'
            - '@IdentificationBundle\Identification\Service\RouteProvider'

    SubscriptionBundle\Subscription\Subscribe\Common\ZeroCreditSubscriptionChecking:
        arguments:
            - '@SubscriptionBundle\SubscriptionPack\SubscriptionPackProvider'
            - '@IdentificationBundle\Repository\CarrierRepositoryInterface'

    SubscriptionBundle\Subscription\Subscribe\Service\SubscribeUrlResolver:
        arguments:
            - '@router'
            - '@SubscriptionBundle\Subscription\Subscribe\Handler\SubscriptionHandlerProvider'

    SubscriptionBundle\Subscription\Subscribe\Service\CreditsCalculator:
        arguments: ['@SubscriptionBundle\Subscription\Renew\Service\RenewDateCalculator']

    SubscriptionBundle\Subscription\Subscribe\Common\AffiliateNotifier:
      arguments: ['@SubscriptionBundle\Affiliate\Service\AffiliateSender', '@SubscriptionBundle\Affiliate\Service\UserInfoMapper']

    SubscriptionBundle\Subscription\Subscribe\Common\SubscriptionEventChecker: ~

    SubscriptionBundle\Subscription\Subscribe\Common\AfterSubscriptionProcessTracker:
      arguments:
        - '@SubscriptionBundle\Subscription\Subscribe\Common\SubscriptionEventTracker'
        - '@SubscriptionBundle\Subscription\Subscribe\Common\AffiliateNotifier'
