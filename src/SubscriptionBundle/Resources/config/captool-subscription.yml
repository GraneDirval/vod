services:

    SubscriptionBundle\CAPTool\Subscription\Notificaton\EmailProvider:
        arguments:
            - '_cap_notification_mail_to_placeholder_'
            - '_cap_notification_mail_from_placeholder_'

    SubscriptionBundle\CAPTool\Subscription\Notificaton\CAPNotificationSender:
        arguments:
            - '@ExtrasBundle\Email\EmailSender'
            - '@SubscriptionBundle\CAPTool\Subscription\Notificaton\EmailProvider'

    SubscriptionBundle\CAPTool\Subscription\SubscriptionLimitCompleter:
        arguments:
            - '@SubscriptionBundle\CAPTool\Subscription\SubscriptionLimiter'
            - '@SubscriptionBundle\Subscription\Common\ProcessResultSuccessChecker'

    SubscriptionBundle\CAPTool\Subscription\SubscriptionLimiter:
        arguments:
        - '@SubscriptionBundle\CAPTool\Subscription\Limiter\LimiterStorage'
        - '@SubscriptionBundle\Subscription\Common\SubscriptionExtractor'
        - '@SubscriptionBundle\CAPTool\Subscription\Limiter\LimiterDataMapper'
        - '@SubscriptionBundle\CAPTool\Subscription\Limiter\SubscriptionCapChecker'
        - '@SubscriptionBundle\CAPTool\Subscription\Limiter\StorageKeyGenerator'
        - '@SubscriptionBundle\Affiliate\Service\CampaignExtractor'
        - '@logger'
        - '@SubscriptionBundle\CAPTool\Subscription\SubscriptionLimitNotifier'


    SubscriptionBundle\CAPTool\Subscription\Limiter\LimiterStorage:
        arguments:
            - '@subscription.captool.redis_client'


    SubscriptionBundle\CAPTool\Subscription\Limiter\LimiterDataMapper:
        arguments:
            - '@SubscriptionBundle\Affiliate\Service\CampaignExtractor'
            - '@IdentificationBundle\Repository\CarrierRepositoryInterface'

    SubscriptionBundle\CAPTool\Subscription\SubscriptionLimitNotifier:
        arguments:
            - '@SubscriptionBundle\CAPTool\Subscription\Notificaton\CAPNotificationSender'
            - '@SubscriptionBundle\Service\EntitySaveHelper'

    SubscriptionBundle\CAPTool\Subscription\Limiter\SubscriptionCapChecker:
        arguments:
            - '@SubscriptionBundle\CAPTool\Subscription\Limiter\LimiterStorage'
            - '@SubscriptionBundle\CAPTool\Subscription\Limiter\StorageKeyGenerator'
            - '@logger'

    SubscriptionBundle\CAPTool\Subscription\Limiter\StorageKeyGenerator: ~



    SubscriptionBundle\CAPTool\Subscription\Command\ResetConstraintsByAffiliateCounters:
        arguments:
            - '@doctrine.orm.entity_manager'
            - '@SubscriptionBundle\Repository\Affiliate\ConstraintByAffiliateRepository'
            - '@SubscriptionBundle\CAPTool\Subscription\Limiter\LimiterStorage'
            - '@SubscriptionBundle\CAPTool\Subscription\Limiter\StorageKeyGenerator'
        tags:
            - { name: console.command }

    SubscriptionBundle\CAPTool\Subscription\Command\ResetConstraintsByCarrierCounters:
        arguments:
            - '@doctrine.orm.entity_manager'
            - '@IdentificationBundle\Repository\CarrierRepositoryInterface'
            - '@SubscriptionBundle\CAPTool\Subscription\Limiter\LimiterStorage'
            - '@SubscriptionBundle\CAPTool\Subscription\Limiter\StorageKeyGenerator'
        tags:
            - { name: console.command }