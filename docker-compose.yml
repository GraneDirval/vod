version: '2'
services:

    redis:
      image: redis:alpine
      ports:
        - 6379:6379
      networks:
       dev-env:
        ipv4_address: 192.168.101.3

    webserver:
      image: nginx:1.15.8-alpine
      volumes:
        - .:/var/www/html
        - .docker/nginx/default.conf:/etc/nginx/conf.d/default.conf
      ports:
        - 8081:80
      networks:
        dev-env:
          ipv4_address: 192.168.101.4
      depends_on:
        - php-fpm

    php-fpm:
     build: .docker/php-fpm
     environment:
       APP_ENV: dev
     volumes:
       - .:/var/www/html
       - .docker/php-fpm/php.ini:/etc/php/7.2/fpm/conf.d/99-docker.ini
       - .docker/php-fpm/www.conf:/etc/php/7.2/fpm/pool.d/www.conf
     networks:
      dev-env:
        ipv4_address: 192.168.101.5

    mysql:
      restart: always
      image: mysql:5.6
      environment:
        MYSQL_ROOT_PASSWORD: '123456'
      volumes:
        - mysql-data:/var/lib/mysql
      ports:
        - 13306:3306
      networks:
       dev-env:
        ipv4_address: 192.168.101.6


volumes:
  mysql-data:


networks:
  dev-env:
   ipam:
     config:
        - subnet: 192.168.101.0/24
